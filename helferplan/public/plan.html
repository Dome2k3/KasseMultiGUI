<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helferplan - Turnier-Planung</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        html, body { overflow-x: hidden; }
        .plan-main { max-width: 1400px; margin: 0 auto; }
        .plan-layout { display: flex; gap: 12px; align-items: flex-start; }
        /* Left panel positioned above timeline grid with sticky positioning */
        .left-panel { 
            width: 240px; 
            flex: 0 0 240px; 
            align-self: flex-start; 
            position: sticky; 
            top: 0; 
            max-height: 95vh; 
            overflow-y: auto; 
            z-index: 15; /* Above timeline */
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 10px;
            font-size: 13px; /* Smaller font for better visibility */
        }
        
        .left-panel h3 {
            font-size: 14px;
            margin-top: 12px;
            margin-bottom: 8px;
        }
        
        .left-panel h3:first-child {
            margin-top: 0;
        }

        #plan-container { overflow-x: auto; flex: 1 1 auto; position: relative; }
        #timeline-header { position: sticky; top: 0; background: #fff; z-index: 10; display:block; }

        /* wichtig: alle relevant boxen box-sizing border-box */
        #timeline-header, #grid-container, .hour-slot, .shift-slot, .activity-name { box-sizing: border-box; }

        .hour-slot { font-size:12px; padding:4px 6px; text-align:center; background:#fafafa; }
        .shift-slot { font-size:12px; padding:6px; min-height:36px; display:flex; align-items:center; justify-content:center; cursor:pointer; overflow:hidden; transition: transform .08s, outline .08s; }
        .shift-slot.filled { color:#fff; }

        .team-item .team-color { padding:6px 8px; border-radius:6px; color:#fff; font-weight:600; display:inline-block; white-space:nowrap; }

        .dimmed { opacity: .28; filter: grayscale(80%); }

        .shift-slot.potential-drop { outline:3px dashed rgba(33,150,243,0.9); transform: translateY(-1px); box-shadow:0 0 0 3px rgba(33,150,243,0.04) inset; }
        .shift-slot.drop-target { outline:3px solid rgba(33,150,243,0.95); transform: translateY(-2px); box-shadow:0 0 0 3px rgba(33,150,243,0.08) inset; }

        .slot-hidden { display:none !important; }

        /* die linke placeholder-zelle im header (falls sichtbar) auf transparent setzen */
        .left-placeholder { background: transparent !important; }

        /* Die linke Spalte (activity name) ist sticky, Teil des selben Grids */
        .activity-name {
            background: #fff;
            position: sticky;
            left: 0;
            z-index: 5;
            padding: 8px;
            border-right: 1px solid #e6e6e6;
            min-height: 36px;
            display:flex;
            align-items:center;
            font-weight:600;
            font-size: 11px; /* Smaller font */
        }

        /* Activity group headers sticky when scrolling horizontally */
        .activity-group-header { 
            padding:8px 0 4px 0; 
            font-weight:700; 
            grid-column:1 / -1; 
            background: #fff; 
            position: sticky; 
            left: 0; 
            z-index: 6;
            font-size: 12px; /* Smaller font */
        }
        #grid-container { overflow: visible; }
    </style>
</head>
<body>
<nav>
    <a href="index.html">Admin: Stammdaten</a>
    <a href="plan.html" class="active">Turnier-Planung</a>
    <a href="plan-admin.html">Turnier-Admin</a>
    <a href="aufbau-abbau.html">Auf-/Abbau</a>
    <a href="kuchen.html">Kuchen</a>
</nav>

<main class="plan-main">
    <h1>Turnier-Planung (Fr 12:00 - So 17:00)</h1>
    <div class="plan-layout">
        <div class="left-panel">
            <h3>Teams</h3>
            <div id="team-list-panel" class="team-list-panel"></div>

            <h3 class="view-filter">Ansicht-Filter (nur Teamfarben)</h3>
            <select id="view-team-filter"><option value="">Alle Teams</option></select>

            <h3>W채hle Team (Filter f체r Helfer)</h3>
            <select id="plan-team-filter"><option value="">-- Team w채hlen --</option></select>

            <h3>Helfer (ziehen)</h3>
            <div id="helper-pool"><div id="helper-pool-empty">W채hle ein Team um Helfer anzuzeigen.</div></div>
        </div>

        <div id="plan-container">
            <div id="timeline-header" aria-hidden="true"></div>
            <div id="grid-container" role="grid"></div>
        </div>
    </div>
</main>

<div id="shift-modal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
        <h2 id="modal-title">Schicht besetzen</h2>
        <p id="modal-subtitle"></p>
        <form id="shift-form">
            <label for="modal-team-select">Team:</label>
            <select id="modal-team-select" required></select>
            <label for="modal-helper-select">Helfer:</label>
            <select id="modal-helper-select" required></select>
            <div class="modal-actions">
                <button type="submit" id="save-shift-button">Speichern</button>
                <button type="button" id="delete-shift-button" class="danger">Schicht leeren</button>
                <button type="button" id="cancel-shift-button">Abbrechen</button>
            </div>
        </form>
    </div>
</div>
<!-- Lade runtime config vor den App-Skripten -->
<script src="/helferplan/public/config.js"></script>
<script src="/helferplan/public/js/plan.js"></script>
</body>
</html>