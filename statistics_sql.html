<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verkaufsstatistiken</title>
    <link rel="stylesheet" href="style_statistics.css"> <!-- Einbinden der CSS-Datei -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Einbinden der Chart.js Bibliothek -->
    <script defer src="statistics.js"></script>
    <style>
        /* Hübscher Button im Stil der anderen (optional, wenn nicht schon in style_statistics.css) */
        .pretty-btn {
            padding: 6px 18px;
            font-size: 15px;
            border-radius: 8px;
            border: none;
            background: linear-gradient(90deg, #f5c542 0%, #facd60 100%);
            color: #444;
            transition: background 0.2s, color 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
            cursor: pointer;
            font-weight: 500;
            opacity: 0.95;
        }
        .pretty-btn:hover, .pretty-btn:focus {
            background: linear-gradient(90deg, #ffe082 0%, #f5c542 100%);
            color: #222;
            box-shadow: 0 2px 8px rgba(0,0,0,0.11);
            opacity: 1;
        }
    </style>
</head>
<body>
<h1>Verkaufsstatistiken</h1>

<!-- Button zum Zurückkehren -->
<div class="action-buttons">
    <button class="back-button" onclick="window.location.href='admin.html'">Admin</button>
    <button class="back-button" onclick="window.location.href='index.html'">Kassen</button>
</div>

<!-- Filter für Datum & Zeitbereich -->
<div class="filter-container">
    <label for="date">Datum:</label>
    <input type="date" id="date">
    <label for="startTime">Von:</label>
    <input type="time" id="startTime">
    <label for="endTime">Bis:</label>
    <input type="time" id="endTime">
    <label for="category">Kategorie:</label>
    <select id="category">
        <option value="">Alle</option>
        <option value="essen">Essen</option>
        <option value="bierzelt">Bierzelt</option>
        <option value="pfand">Pfand</option>
        <option value="fruehstueck">Frühstück</option>
    </select>
    <button onclick="filterStatistics()">Filtern</button>
</div>

<!-- Gesamtverkaufsstatistiken -->
<h2>Gesamtstatistik</h2>
<table>
    <thead>
    <tr>
        <th>Datum</th>
        <th>Anzahl Bons</th>
        <th>Gesamtumsatz (€)</th>
        <th>Ø Bon-Wert (€)</th>
    </tr>
    </thead>
    <tbody id="bonStatsTable"></tbody>
</table>

<!-- Kategorie-Statistik UND E-Mail-Button -->
<h2>Kategorie-Statistik</h2>

<!-- Hübscher Button für E-Mail-Versand -->
<div style="margin-bottom: 1em;">
    <button id="sendStatsMailBtn" class="pretty-btn">Tagesstatistik per E-Mail senden</button>
</div>

<table>
    <thead>
    <tr>
        <th>Kategorie</th>
        <th>Anzahl Bons</th>
        <th>Gesamtumsatz (€)</th>
        <th>⌀ Bon (€)</th>
    </tr>
    </thead>
    <tbody id="categoryStatsTable"></tbody>
</table>

<!-- Verkaufsstatistik für 14 Artikel -->
<h2>Verkaufsstatistik nach Artikel</h2>
<table>
    <thead>
    <tr>
        <th>Artikel</th>
        <th>Verkaufte Menge</th>
        <th>Gesamtumsatz (€)</th>
        <th>Artikel</th>
        <th>Verkaufte Menge</th>
        <th>Gesamtumsatz (€)</th>
    </tr>
    </thead>
    <tbody id="productStatsTable"></tbody>
</table>

<!-- Verkaufsstatistik in 15-Minuten-Intervallen -->
<h2 style="margin-bottom: 0;">Verkäufe in 15-Minuten-Intervallen</h2>

<button onclick="toggleTable()" style="margin-bottom: 10px;">Tabelle anzeigen</button>

<div id="tableContainer" style="display: none;">
    <table>
        <thead>
        <tr>
            <th>Intervall</th>
            <th>Artikel</th>
            <th>Verkaufte Menge</th>
        </tr>
        </thead>
        <tbody id="intervalStatsTable">
        <!-- Dynamische Daten -->
        </tbody>
    </table>
</div>

<script>
    function toggleTable() {
        const container = document.getElementById("tableContainer");
        const button = event.target;

        if (container.style.display === "none") {
            container.style.display = "block";
            button.textContent = "Tabelle ausblenden";
        } else {
            container.style.display = "none";
            button.textContent = "Tabelle anzeigen";
        }
    }
</script>


<!-- Diagramm -->
<h2>Diagramm der Verkaufsstatistiken</h2>
<canvas id="salesChart" width="400" height="200"></canvas>
</body>
</html>

<!-- Modal für E-Mail-Eingabe -->
<div id="mailModal" style="display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); z-index:1000; align-items:center; justify-content:center;">
    <div style="background:#fff; padding:1.5em; border-radius:10px; max-width:95vw; min-width:300px;">
        <span id="closeMailModal" style="float:right; cursor:pointer;">&#10005;</span>
        <h3>Statistik per E-Mail versenden</h3>
        <form id="mailForm" autocomplete="off">
            <label for="emailInput">Empfänger E-Mail:</label>
            <input type="email" id="emailInput" name="email" required style="width:100%; margin-bottom:1em;" />
            <button type="submit">Senden</button>
        </form>
        <div id="mailStatusMsg" style="margin-top:0.5em; color:#333;"></div>
    </div>
</div>